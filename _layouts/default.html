<!doctype html>
<html lang="{{ page.lang | default: site.lang | default: 'en' }}">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% if page.title %}{{ page.title }} | {% endif %}AI Expert Toolkit</title>

  {%- assign meta_desc = page.description | default: site.description -%}
  {%- if meta_desc -%}<meta name="description" content="{{ meta_desc | escape }}">{%- endif -%}

  <!-- Robots: allow per-page override; include large previews for Discover -->
  <meta name="robots" content="{% if page.noindex %}noindex, nofollow{% else %}index, follow, max-image-preview:large{% endif %}">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta name="theme-color" content="#0b1220">
  <meta name="color-scheme" content="dark light">

  {%- comment -%} Canonical URL: page.canonical_url wins; else site.url + site.baseurl + page.url {%- endcomment -%}
  {%- if page.canonical_url and page.canonical_url != '' -%}
    {%- assign canonical = page.canonical_url -%}
  {%- else -%}
    {%- assign canonical = site.url | append: site.baseurl | append: page.url -%}
  {%- endif -%}
  <link rel="canonical" href="{{ canonical }}">

  <!-- Optional: preconnect to vendor domains (set page.preconnect_domains: ['https://writesonic.com']) -->
  {%- if page.preconnect_domains -%}
    {%- for d in page.preconnect_domains -%}
      <link rel="dns-prefetch" href="{{ d | replace: 'https://','//' | replace: 'http://','//' }}">
      <link rel="preconnect" href="{{ d }}" crossorigin>
    {%- endfor -%}
  {%- endif -%}

  <!-- Optional: LCP hero image preload & priority (set page.lcp_image:'/assets/img/home/hero-1200.jpg') -->
  {%- if page.lcp_image and page.lcp_image != '' -%}
    {%- assign lcp_abs = site.url | append: site.baseurl | append: page.lcp_image -%}
    <link rel="preload" as="image" href="{{ lcp_abs }}" fetchpriority="high">
  {%- endif -%}

  <!-- Open Graph / Twitter -->
  <meta property="og:site_name" content="AI Expert Toolkit">
  <meta property="og:type" content="website">
  <meta property="og:title" content="{% if page.title %}{{ page.title }} | {% endif %}AI Expert Toolkit">
  {%- if meta_desc -%}<meta property="og:description" content="{{ meta_desc | escape }}">{%- endif -%}
  <meta property="og:url" content="{{ canonical }}">
  <meta property="og:locale" content="{{ page.og_locale | default: 'en_US' }}">

  {%- comment -%} OG image (supports relative/absolute), width/height/alt {%- endcomment -%}
  {%- assign ogimg = page.og_image | default: site.og_image -%}
  {%- if ogimg and ogimg != '' -%}
    {%- if ogimg contains '://' -%}{%- assign ogimg_abs = ogimg -%}{%- else -%}{%- assign ogimg_abs = site.url | append: site.baseurl | append: ogimg -%}{%- endif -%}
    <meta property="og:image" content="{{ ogimg_abs }}">
    {%- if page.og_image_width -%}<meta property="og:image:width" content="{{ page.og_image_width }}">{%- endif -%}
    {%- if page.og_image_height -%}<meta property="og:image:height" content="{{ page.og_image_height }}">{%- endif -%}
    {%- if page.og_image_alt -%}<meta property="og:image:alt" content="{{ page.og_image_alt | escape }}">{%- endif -%}
    <meta name="twitter:card" content="summary_large_image">
  {%- else -%}
    <meta name="twitter:card" content="summary">
  {%- endif -%}

  <!-- CSS -->
  <link rel="stylesheet" href="{{ site.baseurl }}/assets/css/base.css">

  <!-- Icons / Manifest (optional) -->
  <link rel="icon" href="{{ site.baseurl }}/assets/ui/favicon.svg" type="image/svg+xml">
  {%- if site.manifest and site.manifest != '' -%}<link rel="manifest" href="{{ site.baseurl }}{{ site.manifest }}">{%- endif -%}
  {%- if site.feed_path and site.feed_path != '' -%}<link rel="alternate" type="application/atom+xml" title="{{ site.title | escape }}" href="{{ site.baseurl }}{{ site.feed_path }}">{%- endif -%}

  <!-- GTM/GA resource hints when enabled -->
  {%- if site.analytics.gtm and site.analytics.gtm != '' -%}
    <link rel="dns-prefetch" href="//www.googletagmanager.com">
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
  {%- endif -%}

  {%- if site.analytics.gtm and site.analytics.gtm != '' -%}
  <!-- Google Tag Manager -->
  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
    j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','{{ site.analytics.gtm }}');
  </script>
  {%- endif -%}

  {%- if site.analytics.ga4 and site.analytics.ga4 != '' -%}
  <!-- Google Analytics 4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.analytics.ga4 }}"></script>
  <script>
    window.dataLayer=window.dataLayer||[];
    function gtag(){dataLayer.push(arguments)}
    gtag('js', new Date());
    gtag('config', '{{ site.analytics.ga4 }}');
  </script>
  {%- endif -%}

  <!-- Organization schema (adds social sameAs if provided) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Organization",
    "name":"AI Expert Toolkit",
    "url":"{{ site.url }}",
    "email":"{{ site.contact_email | escape }}"{% if site.social_sameas and site.social_sameas.size > 0 %},
    "sameAs": {{ site.social_sameas | jsonify }}{% endif %}
  }
  </script>

  {%- comment -%} Optional page-level BreadcrumbList (set `breadcrumbs:` array in front matter) {%- endcomment -%}
  {%- if page.breadcrumbs -%}
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {%- for crumb in page.breadcrumbs -%}
        {"@type":"ListItem","position":{{ forloop.index }},"name":"{{ crumb.name | escape }}","item":"{{ site.url }}{{ crumb.url }}"}{% if forloop.last == false %},{% endif %}
      {%- endfor -%}
    ]
  }
  </script>
  {%- endif -%}

  {%- comment -%} Optional per-page schema: put a YAML object `schema:` in front matter {%- endcomment -%}
  {%- if page.schema -%}
  <script type="application/ld+json">
    {{ page.schema | jsonify }}
  </script>
  {%- endif -%}
</head>
<body>
  {%- if site.analytics.gtm and site.analytics.gtm != '' -%}
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id={{ site.analytics.gtm }}"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  {%- endif -%}

  <a class="skip" href="#content">Skip to content</a>
  {% include header.html %}

  <main id="content" class="wrap" role="main">
    {{ content }}
  </main>

  {% include footer.html %}
</body>
</html>
