<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Photo Splitter — AI Expert Toolkit</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;margin:0;padding:32px;line-height:1.45;color:#111}
    h1{font-size:28px;margin:0 0 8px}
    p.note{color:#555;margin:0 0 16px}
    .card{border:1px solid #e5e7eb;border-radius:12px;padding:16px;max-width:920px}
    .row{display:flex;flex-wrap:wrap;gap:16px;align-items:flex-start}
    .col{flex:1 1 280px}
    .btn{display:inline-block;border:1px solid #111;border-radius:10px;padding:10px 14px;text-decoration:none;color:#111;background:#fff;cursor:pointer}
    .btn.primary{background:#111;color:#fff;border-color:#111}
    .stack{display:flex;gap:8px;flex-wrap:wrap}
    canvas, img{max-width:100%;height:auto;border:1px solid #eee;border-radius:8px}
    .tiles{display:flex;gap:8px;flex-wrap:wrap}
    footer{margin-top:24px;color:#666;font-size:13px}
  </style>
</head>
<body>
  <h1>Photo Splitter</h1>
  <p class="note">Upload one photo → get multiple sizes instantly. Free 2x2. Premium unlocks 10×10 + ZIP.</p>

  <div class="card">
    <div class="row">
      <div class="col">
        <input id="file" type="file" accept="image/*" class="btn" />
        <div style="margin-top:12px">
          <button id="splitBtn" class="btn primary">Split into 2×2 (Free)</button>
          <button id="zipBtn" class="btn" disabled>Download ZIP</button>
        </div>
        <div style="margin-top:12px" class="stack">
          <a id="buyBtn" class="btn" href="https://buy.stripe.com/00wdR9e8f6S1434cAe8k800" target="_blank" rel="noopener">Go Premium (.99)</a>
        </div>
      </div>
      <div class="col">
        <img id="preview" alt="preview" style="display:none" />
        <div id="tiles" class="tiles" style="margin-top:12px"></div>
      </div>
    </div>
  </div>

  <footer>© AI Expert Toolkit</footer>

  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
  <script>
    const file = document.getElementById('file');
    const preview = document.getElementById('preview');
    const tilesEl = document.getElementById('tiles');
    const splitBtn = document.getElementById('splitBtn');
    const zipBtn = document.getElementById('zipBtn');

    let sourceImg = null;
    let canvases = [];

    file.addEventListener('change', e=>{
      const f = e.target.files && e.target.files[0];
      if(!f) return;
      const url = URL.createObjectURL(f);
      preview.src = url;
      preview.style.display = 'block';
      sourceImg = new Image();
      sourceImg.onload = ()=> URL.revokeObjectURL(url);
      sourceImg.src = url;
      tilesEl.innerHTML = '';
      canvases = [];
      zipBtn.disabled = true;
    });

    splitBtn.addEventListener('click', ()=>{
      if(!sourceImg){ alert('Choose a photo first'); return; }
      const cols = 2, rows = 2; // free tier
      const w = Math.floor(sourceImg.naturalWidth / cols);
      const h = Math.floor(sourceImg.naturalHeight / rows);
      tilesEl.innerHTML = '';
      canvases = [];
      for(let r=0;r<rows;r++){
        for(let c=0;c<cols;c++){
          const cv = document.createElement('canvas');
          cv.width = w; cv.height = h;
          const ctx = cv.getContext('2d');
          ctx.drawImage(sourceImg, c*w, r*h, w, h, 0, 0, w, h);
          canvases.push(cv);
          tilesEl.appendChild(cv);
        }
      }
      zipBtn.disabled = false;
    });

    zipBtn.addEventListener('click', async ()=>{
      if(!canvases.length) return;
      const zip = new JSZip();
      let i=1;
      for(const cv of canvases){
        const blob = await new Promise(res=> cv.toBlob(res, 'image/png'));
        zip.file(\	ile_\.png\, blob);
      }
      const out = await zip.generateAsync({type:'blob'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(out);
      a.download = 'photo-splitter-2x2.zip';
      a.click();
    });
  </script>
</body>
</html>
