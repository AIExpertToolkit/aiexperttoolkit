{% assign cta_url = include.cta_url %}
{% assign cta_label = include.cta_label | default: 'Start Free' %}
{% assign cta_mode = include.cta_mode  | default: 'both' %} {# both|time|scroll|exit #}

<div class="mini-cta" role="region" aria-label="Get started" hidden>
  <a class="btn mini-cta__button"
     href="{{ cta_url }}"
     target="_blank"
     data-aff="true"
     rel="{% if site.header_cta_sponsored %}sponsored {% endif %}nofollow noopener">
    {{ cta_label }}
  </a>
  <button class="mini-cta__close" aria-label="Hide">Ã—</button>
</div>

<style>
  .mini-cta{ position:fixed; right:16px; bottom:16px; z-index:60; background:#0f172a; border:1px solid rgba(255,255,255,.1); padding:.6rem .7rem; border-radius:.9rem; box-shadow:0 8px 30px rgba(0,0,0,.3) }
  .mini-cta__button{ margin-right:.4rem }
  .mini-cta__close{ background:transparent; border:1px solid rgba(255,255,255,.35); color:#e6f1ff; border-radius:.5rem; padding:.2rem .5rem; cursor:pointer }
</style>

<script>
(function(){
  try{
    const box = document.querySelector('.mini-cta');
    const btn = box.querySelector('.mini-cta__button');
    const closeBtn = box.querySelector('.mini-cta__close');
    const mode = "{{ cta_mode }}";

    function reveal(){ box.hidden = false; }
    function hide(){ box.hidden = true; localStorage.setItem('mini_cta_hide','1'); }

    if (localStorage.getItem('mini_cta_hide') === '1') return;

    if (mode === 'both' || mode === 'time'){ setTimeout(reveal, 15000); }
    if (mode === 'both' || mode === 'scroll'){
      window.addEventListener('scroll', function onScr(){
        if (window.scrollY > 800){ reveal(); window.removeEventListener('scroll', onScr); }
      }, {passive:true});
    }
    if (mode === 'both' || mode === 'exit'){
      document.addEventListener('mouseout', function(e){
        if (e.relatedTarget === null && e.clientY <= 0) reveal();
      });
    }

    // Decorate URL if header helper exists
    try{ if (btn && btn.href) btn.href = (function(h){ return h; })(btn.href); }catch(_){}

    closeBtn.addEventListener('click', hide);
  }catch(_){}
})();
</script>
